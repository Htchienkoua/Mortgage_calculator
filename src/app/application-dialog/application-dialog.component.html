<h1 mat-dialog-title>Application for a Mortgage Loan</h1>
<div mat-dialog-content>
  <mat-stepper orientation="vertical" [linear]="isLinear">
        <mat-step step [stepControl]="incomeDetailsForm">
      <form [formGroup]="incomeDetailsForm">
        <ng-template matStepLabel>Income information</ng-template>
        <div>
          <mat-label class="block">Number of Applicants</mat-label>
        </div>
        <div class="form-field-wrapper">
          <mat-radio-group
            aria-label="Number of applicants"
            formControlName="applicants"
            color="primary">
            <mat-radio-button
              *ngFor="let applicant of applicants"
              [value]="applicant">
              {{ applicant }}
            </mat-radio-button>
          </mat-radio-group>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Number of kids</mat-label>
            <mat-select formControlName="amountOfKids">
              <mat-option *ngFor="let kid of children" [value]="kid">
                {{ kid }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field class="input-wrap">
            <mat-label>Income</mat-label>
            <input matInput formControlName="income"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-label class="block">Do you have any obligations?</mat-label>
          <mat-icon
            matSuffix
            matTooltip="Represent any outstanding debts or regular payments that a party must make."
            [matTooltipPosition]="'right'"
          >help_outline
          </mat-icon>
        </div>
        <mat-radio-group
          aria-label="Select an option"
          formControlName="obligations"
          color="primary"
        >
          <mat-radio-button [value]="false">No
          </mat-radio-button>
          <mat-radio-button [value]="true">Yes
          </mat-radio-button>
        </mat-radio-group>
        <div *ngIf="obligations.value == true">
          <ng-container *ngFor="let field of obligationFields">
            <div class="form-field-wrapper">
              <mat-form-field class="input-wrap">
                <mat-label>{{ field.label }}</mat-label>
                <input matInput formControlName="{{ field.controlName }}"/>
              </mat-form-field>
            </div>
          </ng-container>
        </div>
      </form>
    </mat-step>

    <mat-step [stepControl]="loanDetailsForm">
      <form [formGroup]="loanDetailsForm" color="accent">
        <ng-template matStepLabel>Loan Details</ng-template>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Real Estate Price</mat-label>
            <input matInput formControlName="realEstatePrice"/>
            <mat-error
              *ngIf="
        realEstatePrice &&
        (realEstatePrice.hasError('required') ||
          realEstatePrice.hasError('pattern'))">
              Please enter a number
            </mat-error>
            <mat-error *ngIf="realEstatePrice && realEstatePrice.hasError('max')">
              Max is {{ maxRealEstatePrice }}
            </mat-error>
            <mat-error *ngIf="realEstatePrice && realEstatePrice.hasError('min')">
              Min is {{ minRealEstatePrice }}
            </mat-error>
          </mat-form-field>

        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Down Payment</mat-label>
            <input matInput formControlName="downPayment"/>
            <mat-error
              *ngIf="
        downPayment &&
        (downPayment.hasError('required') ||
          downPayment.hasError('pattern'))">
              Please enter a number
            </mat-error>
            <mat-error *ngIf="downPayment && downPayment.hasError('min')">
              Min is {{ minDownPaymentAmount }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Loan Amount</mat-label>
            <input matInput formControlName="loanAmount"/>
            <mat-error
              *ngIf="
        loanAmount &&
        (loanAmount.hasError('pattern') ||
         loanAmount.hasError('required'))">
              Please enter a valid number
            </mat-error>
            <mat-error *ngIf="loanAmount && loanAmount.hasError('max')">
              Max is {{ maxLoanAmount.toFixed(0) }}
            </mat-error>
            <mat-error *ngIf="loanAmount && loanAmount.hasError('min')">
              Min is {{ minLoanAmount }}
            </mat-error>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field class="input-wrap">
            <mat-label>Loan term years</mat-label>
            <input matInput formControlName="loanTerm"/>
            <mat-error *ngIf="loanTerm && loanTerm.hasError('pattern')">
              Please enter a valid number
            </mat-error>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field class="input-wrap">
            <mat-label>Euribor</mat-label>
            <mat-select formControlName="euribor">
              <mat-option
                *ngFor="let euribor of euriborValues"
                [value]="euribor"
              >{{ euribor.timeInMonths }} Months
                <span *ngIf="euribor.interestRate !== null">
                  - {{ euribor.interestRate.toFixed(3) }}%</span
                >
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-label class="block">Payment Schedule Type</mat-label>
          <mat-icon
            matSuffix
            [matTooltip]="
              'Annuity - identical monthly installments;
             Linear - identical monthly principle, interest is calculated on outstanding principle'
            "
            [matTooltipPosition]="'right'"
            fontIcon="help_outline"
          ></mat-icon>
        </div>
        <div class="form-field-wrapper">
          <mat-radio-group
            aria-label="Payment schedule options"
            formControlName="paymentScheduleType"
            color="accent"
          >
            <mat-radio-button
              *ngFor="let type of paymentScheduleTypes"
              [value]="type"
            >
              {{ type | titlecase }}
            </mat-radio-button>
          </mat-radio-group>
        </div>
      </form>
    </mat-step>

    <mat-step step [stepControl]="personalDetailsForm">
      <form [formGroup]="personalDetailsForm">
        <ng-template matStepLabel>Personal Details</ng-template>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Personal Number</mat-label>
            <input matInput formControlName="personalNumber"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Email</mat-label>
            <input matInput formControlName="email"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Phone Number</mat-label>
            <input matInput formControlName="phoneNumber"/>
          </mat-form-field>
        </div>
        <div class="form-field-wrapper">
          <mat-form-field>
            <mat-label>Address</mat-label>
            <input matInput formControlName="address"/>
          </mat-form-field>
        </div>
      </form>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Form Submission</ng-template>
      <div>If the info is correct, click Done to submit the form.</div>
      <div>
        <button mat-raised-button mat-dialog-close class="form-button" (click)="onSubmitApplyClick()">Submit
          Application
        </button>
      </div>
    </mat-step>
  </mat-stepper>
</div>
